From 4038418f210714d41b12b8b1e6ea5800b17ef599 Mon Sep 17 00:00:00 2001
From: Kentlakers <kent24800@gmail.com>
Date: Fri, 15 May 2015 02:06:32 +0800
Subject: [PATCH] [Volume] Add notification function

---
 app/src/main/java/com/app/kent/volume/Main.java | 32 ++++++++++++++++++++
 app/src/main/res/layout/custom_notification.xml | 40 +++++++++++++++++++++++++
 app/src/main/res/menu/menu_main.xml             | 12 ++++++--
 app/src/main/res/values/strings.xml             |  1 +
 4 files changed, 82 insertions(+), 3 deletions(-)
 create mode 100644 app/src/main/res/layout/custom_notification.xml

diff --git a/app/src/main/java/com/app/kent/volume/Main.java b/app/src/main/java/com/app/kent/volume/Main.java
index ca368b6..8dc5375 100644
--- a/app/src/main/java/com/app/kent/volume/Main.java
+++ b/app/src/main/java/com/app/kent/volume/Main.java
@@ -1,10 +1,12 @@
 package com.app.kent.volume;
 
+import android.app.NotificationManager;
 import android.content.Context;
 import android.content.SharedPreferences;
 import android.media.AudioManager;
 import android.os.Bundle;
 import android.preference.PreferenceManager;
+import android.support.v4.app.NotificationCompat;
 import android.support.v7.app.ActionBarActivity;
 import android.text.Html;
 import android.util.Log;
@@ -14,6 +16,7 @@ import android.view.View;
 import android.view.ViewGroup;
 import android.widget.Button;
 import android.widget.LinearLayout;
+import android.widget.RemoteViews;
 import android.widget.SeekBar;
 import android.widget.TextView;
 import android.widget.Toast;
@@ -390,6 +393,10 @@ public class Main extends ActionBarActivity {
     @Override
     public boolean onOptionsItemSelected(MenuItem item) {
         switch (item.getItemId()) {
+            case R.id.action_notification:
+                actionNotification();
+                return true;
+
             case R.id.action_custom:
                 actionCustiom();
                 return true;
@@ -408,6 +415,31 @@ public class Main extends ActionBarActivity {
         return super.onOptionsItemSelected(item);
     }
 
+    public void actionNotification() {
+        RemoteViews contentViews = new RemoteViews(getPackageName(), R.layout.custom_notification);
+
+        //³q?±±¥óªºId?¸m?©Ê
+        contentViews.setImageViewResource(R.id.imageNo, R.drawable.ic_launcher);
+        contentViews.setTextViewText(R.id.titleNo, "title");
+        contentViews.setTextViewText(R.id.textNo, "content");
+
+//        Intent intent = new Intent(MainActivity.this, ResultActivity.class);
+//
+//        PendingIntent pendingIntent = PendingIntent.getActivity(MainActivity.this, 0, intent,
+//                        PendingIntent.FLAG_CANCEL_CURRENT);
+        NotificationCompat.Builder mBuilder = new NotificationCompat.Builder(
+                Main.this).setSmallIcon(R.drawable.ic_launcher)
+                .setContentTitle("My notification")
+                .setTicker("new message");
+        mBuilder.setAutoCancel(true);
+
+//        mBuilder.setContentIntent(pendingIntent);
+        mBuilder.setContent(contentViews);
+        mBuilder.setAutoCancel(true);
+        NotificationManager mNotificationManager = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);
+        mNotificationManager.notify(10, mBuilder.build());
+    }
+
     public void actionCustiom() {
         final CustomDialog mCustomDialog = new CustomDialog(this, getWindow().getDecorView().getRootView());
 
diff --git a/app/src/main/res/layout/custom_notification.xml b/app/src/main/res/layout/custom_notification.xml
new file mode 100644
index 0000000..30e04b5
--- /dev/null
+++ b/app/src/main/res/layout/custom_notification.xml
@@ -0,0 +1,40 @@
+<?xml version="1.0" encoding="utf-8"?>
+<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:padding="10dp">
+
+    <ImageView
+        android:id="@+id/imageNo"
+        android:layout_width="wrap_content"
+        android:layout_height="match_parent"
+        android:layout_alignParentLeft="true"
+        android:layout_marginRight="10dp" />
+
+    <TextView
+        android:id="@+id/titleNo"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_toRightOf="@id/imageNo" />
+
+    <TextView
+        android:id="@+id/textNo"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_below="@id/titleNo"
+        android:layout_toRightOf="@id/imageNo" />
+
+    <Button
+        android:id="@+id/btn_up"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_toRightOf="@+id/titleNo"
+        android:text="up"/>
+
+    <Button
+        android:id="@+id/btn_down"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_toRightOf="@+id/btn_up"
+        android:text="down"/>
+</RelativeLayout>
\ No newline at end of file
diff --git a/app/src/main/res/menu/menu_main.xml b/app/src/main/res/menu/menu_main.xml
index 1776939..0f278f7 100644
--- a/app/src/main/res/menu/menu_main.xml
+++ b/app/src/main/res/menu/menu_main.xml
@@ -3,20 +3,26 @@
     xmlns:tools="http://schemas.android.com/tools" tools:context=".Main">
 
     <item
+        android:id="@+id/action_notification"
+        android:title="@string/menu_notification"
+        android:orderInCategory="100"
+        app:showAsAction="always" />
+
+    <item
         android:id="@+id/action_custom"
         android:title="@string/menu_custom"
-        android:orderInCategory="100"
+        android:orderInCategory="200"
         app:showAsAction="always" />
     <item
         android:id="@+id/action_about"
         android:title="@string/menu_about"
-        android:orderInCategory="200"
+        android:orderInCategory="300"
         app:showAsAction="never" />
 
     <item
         android:id="@+id/action_feedback"
         android:title="@string/menu_feedback"
-        android:orderInCategory="300"
+        android:orderInCategory="400"
         app:showAsAction="never" />
 
 </menu>
diff --git a/app/src/main/res/values/strings.xml b/app/src/main/res/values/strings.xml
index af6b1df..c4620a1 100644
--- a/app/src/main/res/values/strings.xml
+++ b/app/src/main/res/values/strings.xml
@@ -19,6 +19,7 @@
     <string name="text_exit">é›¢é–‹</string>
 
 
+    <string name="menu_notification">é€šçŸ¥</string>
     <string name="menu_custom">è‡ªè¨‚</string>
     <string name="menu_about">èªªæ˜Ž</string>
     <string name="menu_feedback">å›žé¥‹</string>
-- 
1.9.5.github.0

